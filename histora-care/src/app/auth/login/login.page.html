<ion-content class="login-content" [fullscreen]="true">
  <div class="login-container">
    <!-- Logo and Brand -->
    <header class="brand-section" role="banner">
      <div class="logo-wrapper" aria-hidden="true">
        <ion-icon name="flash" class="logo-icon"></ion-icon>
      </div>
      <h1 class="app-name">NurseLite</h1>
      <p class="app-tagline">Tu enfermera a un toque</p>
    </header>

    <!-- Login Form -->
    <main class="form-section" role="main">
      <h2 class="form-title">Iniciar Sesion</h2>

      <form [formGroup]="loginForm" (ngSubmit)="onSubmit()" aria-label="Formulario de inicio de sesion">
        <!-- Email Field -->
        <ion-item lines="none" class="input-item" [class.input-error]="email?.invalid && email?.touched">
          <ion-icon name="mail-outline" slot="start" class="input-icon" aria-hidden="true"></ion-icon>
          <ion-input
            type="email"
            formControlName="email"
            placeholder="Correo electrónico"
            autocomplete="email"
            inputmode="email"
            aria-label="Correo electrónico"
            [attr.aria-invalid]="email?.invalid && email?.touched"
            [attr.aria-describedby]="email?.invalid && email?.touched ? 'email-error' : null">
          </ion-input>
        </ion-item>
        <div id="email-error" class="error-message" role="alert" *ngIf="email?.invalid && email?.touched">
          <span *ngIf="email?.errors?.['required']">El correo es requerido</span>
          <span *ngIf="email?.errors?.['email']">Ingresa un correo válido</span>
        </div>

        <!-- Password Field -->
        <ion-item lines="none" class="input-item" [class.input-error]="password?.invalid && password?.touched">
          <ion-icon name="lock-closed-outline" slot="start" class="input-icon" aria-hidden="true"></ion-icon>
          <ion-input
            [type]="showPassword ? 'text' : 'password'"
            formControlName="password"
            placeholder="Contraseña"
            autocomplete="current-password"
            aria-label="Contraseña"
            [attr.aria-invalid]="password?.invalid && password?.touched"
            [attr.aria-describedby]="password?.invalid && password?.touched ? 'password-error' : null">
          </ion-input>
          <ion-button
            fill="clear"
            slot="end"
            (click)="togglePassword()"
            class="password-toggle"
            type="button"
            [attr.aria-label]="showPassword ? 'Ocultar contraseña' : 'Mostrar contraseña'"
            [attr.aria-pressed]="showPassword">
            <ion-icon [name]="showPassword ? 'eye-off-outline' : 'eye-outline'" aria-hidden="true"></ion-icon>
          </ion-button>
        </ion-item>
        <div id="password-error" class="error-message" role="alert" *ngIf="password?.invalid && password?.touched">
          <span *ngIf="password?.errors?.['required']">La contraseña es requerida</span>
          <span *ngIf="password?.errors?.['minlength']">Mínimo 8 caracteres</span>
        </div>

        <!-- Remember Me & Forgot Password -->
        <div class="options-row">
          <ion-checkbox formControlName="rememberMe" labelPlacement="end">
            Recordarme
          </ion-checkbox>
          <ion-button fill="clear" size="small" class="forgot-btn" (click)="forgotPassword()">
            ¿Olvidaste tu contraseña?
          </ion-button>
        </div>

        <!-- Login Button -->
        <ion-button
          expand="block"
          type="submit"
          class="login-btn"
          [disabled]="loginForm.invalid"
          aria-label="Iniciar sesion">
          <ion-icon name="log-in-outline" slot="start" aria-hidden="true"></ion-icon>
          Iniciar Sesion
        </ion-button>
      </form>

      <!-- Divider -->
      <div class="divider" role="separator" aria-hidden="true">
        <span>o continuar con</span>
      </div>

      <!-- Social Login -->
      <div class="social-login">
        <ion-button
          expand="block"
          fill="outline"
          class="google-btn"
          (click)="signInWithGoogle()"
          [disabled]="googleAuthPending()"
          aria-label="Iniciar sesion con Google">
          @if (googleAuthPending()) {
            <ion-spinner name="crescent" slot="start" aria-hidden="true"></ion-spinner>
            <span>Conectando...</span>
          } @else {
            <ion-icon name="logo-google" slot="start" aria-hidden="true"></ion-icon>
            <span>Google</span>
          }
        </ion-button>
      </div>

      <!-- Register Link -->
      <div class="register-section">
        <p>¿No tienes una cuenta?</p>
        <ion-button expand="block" fill="outline" class="register-btn" (click)="goToRegister()" aria-label="Crear una cuenta nueva">
          <ion-icon name="person-add-outline" slot="start" aria-hidden="true"></ion-icon>
          Crear Cuenta
        </ion-button>
      </div>
    </main>

    <!-- Footer -->
    <footer class="footer-section" role="contentinfo">
      <p class="version">Version 1.0.0</p>
    </footer>
  </div>
</ion-content>
