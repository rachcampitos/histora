<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>Ajustes</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">Ajustes</ion-title>
    </ion-toolbar>
  </ion-header>

  <!-- Profile Section -->
  <div class="profile-section">
    <div class="profile-avatar-wrapper" (click)="changeAvatar($event)">
      <div class="profile-avatar">
        @if (user()?.avatar) {
          <img [src]="user().avatar" alt="Avatar" />
        } @else {
          <ion-icon name="person"></ion-icon>
        }
      </div>
      <div class="avatar-edit-badge">
        <ion-icon name="camera"></ion-icon>
      </div>
      @if (isUploadingAvatar()) {
        <div class="avatar-loading">
          <ion-spinner name="crescent" color="light"></ion-spinner>
        </div>
      }
    </div>
    <div class="profile-info" (click)="editProfile()">
      <h2>{{ user()?.firstName || 'Usuario' }} {{ user()?.lastName || '' }}</h2>
      <p>{{ user()?.email || '' }}</p>
    </div>
    <ion-icon name="chevron-forward" (click)="editProfile()"></ion-icon>
  </div>

  <!-- Settings List -->
  <ion-list>
    <ion-list-header>
      <ion-label>Preferencias</ion-label>
    </ion-list-header>

    <ion-item button detail="false" (click)="openThemeSelector()">
      <ion-icon [name]="themeService.getThemeIcon(themeService.currentTheme())" slot="start" color="primary"></ion-icon>
      <ion-label>
        <h3>Tema</h3>
        <p>{{ themeService.getThemeLabel(themeService.currentTheme()) }}</p>
      </ion-label>
      <ion-icon name="chevron-forward" slot="end" color="medium"></ion-icon>
    </ion-item>

    <ion-item button detail="false" (click)="openNotificationSettings()">
      <ion-icon name="notifications-outline" slot="start" color="primary"></ion-icon>
      <ion-label>Notificaciones</ion-label>
      <ion-icon name="chevron-forward" slot="end" color="medium"></ion-icon>
    </ion-item>

    <ion-item button detail="false" (click)="openPaymentMethods()">
      <ion-icon name="card-outline" slot="start" color="primary"></ion-icon>
      <ion-label>Métodos de Pago</ion-label>
      <ion-icon name="chevron-forward" slot="end" color="medium"></ion-icon>
    </ion-item>
  </ion-list>

  <ion-list>
    <ion-list-header>
      <ion-label>Información</ion-label>
    </ion-list-header>

    <ion-item button detail="false" (click)="replayTour()">
      <ion-icon name="school-outline" slot="start" color="primary"></ion-icon>
      <ion-label>Ver tutorial de la app</ion-label>
      <ion-icon name="chevron-forward" slot="end" color="medium"></ion-icon>
    </ion-item>

    <ion-item button detail="false" (click)="openHelp()">
      <ion-icon name="help-circle-outline" slot="start" color="primary"></ion-icon>
      <ion-label>Centro de Ayuda</ion-label>
      <ion-icon name="chevron-forward" slot="end" color="medium"></ion-icon>
    </ion-item>

    <ion-item button detail="false" (click)="openPrivacy()">
      <ion-icon name="shield-outline" slot="start" color="primary"></ion-icon>
      <ion-label>Privacidad</ion-label>
      <ion-icon name="chevron-forward" slot="end" color="medium"></ion-icon>
    </ion-item>

    <ion-item button detail="false" (click)="openTerms()">
      <ion-icon name="document-text-outline" slot="start" color="primary"></ion-icon>
      <ion-label>Términos y Condiciones</ion-label>
      <ion-icon name="chevron-forward" slot="end" color="medium"></ion-icon>
    </ion-item>
  </ion-list>

  <ion-list>
    <ion-item button detail="false" (click)="logout()" class="logout-item">
      <ion-icon name="log-out-outline" slot="start" color="danger"></ion-icon>
      <ion-label color="danger">Cerrar Sesión</ion-label>
    </ion-item>
  </ion-list>

  <div class="app-version">
    <p>NurseLite v1.0.0</p>
    <p class="powered-by">by Histora Health</p>
  </div>
</ion-content>
