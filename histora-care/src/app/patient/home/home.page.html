<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>Inicio</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-header collapse="condense">
    <ion-toolbar>
      <ion-title size="large">Inicio</ion-title>
    </ion-toolbar>
  </ion-header>

  <!-- Hero Section - Compact -->
  <section class="hero-section" role="banner" id="tour-main-action">
    <div class="hero-content">
      <!-- Inline Greeting -->
      <div class="greeting-inline">
        @if (user()?.avatar) {
          <img [src]="user()!.avatar" class="hero-avatar"
               [alt]="'Foto de perfil de ' + (user()?.firstName || 'usuario')" loading="eager" />
        } @else {
          <div class="hero-avatar hero-avatar-placeholder">
            <ion-icon name="person" aria-hidden="true"></ion-icon>
          </div>
        }
        <span class="greeting-text">Hola {{ user()?.firstName || 'Usuario' }}, ¿como te ayudamos hoy?</span>
      </div>

      <!-- Main CTA -->
      <button
        class="hero-cta"
        (click)="goToMap()"
        aria-label="Buscar enfermera disponible cerca de ti">
        <div class="cta-content">
          <ion-icon name="search-outline" class="cta-icon"></ion-icon>
          <span class="cta-text">Necesito una enfermera</span>
        </div>
        <ion-icon name="chevron-forward" class="cta-arrow"></ion-icon>
      </button>

      <!-- Trust Badges - Enhanced with warm colors -->
      <div class="trust-badges-enhanced">
        <div class="trust-badge">
          <ion-icon name="shield-checkmark"></ion-icon>
          <div class="badge-content">
            <span class="badge-title">100% Verificadas</span>
            <span class="badge-subtitle">Colegio de Enfermeros</span>
          </div>
        </div>
        <div class="trust-badge">
          <ion-icon name="time"></ion-icon>
          <div class="badge-content">
            <span class="badge-title">Atencion 24/7</span>
            <span class="badge-subtitle">Todos los dias</span>
          </div>
        </div>
        <div class="trust-badge">
          <ion-icon name="people"></ion-icon>
          <div class="badge-content">
            <span class="badge-title">+500 servicios</span>
            <span class="badge-subtitle">Este mes en Lima</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Active Request Section - Only if exists -->
  @if (activeRequest()) {
    <section class="active-request-section" aria-labelledby="active-request-title">
      <h3 id="active-request-title" class="visually-hidden">Solicitud en progreso</h3>

      <ion-card
        class="request-card-compact"
        button
        (click)="viewActiveRequest()"
        role="button"
        aria-label="Ver seguimiento de solicitud activa">
        <ion-card-content>
          <div class="request-compact-layout">
            <!-- Avatar + Info -->
            <div class="nurse-compact">
              @if (activeRequest()!.nurse?.avatar) {
                <img
                  [src]="activeRequest()!.nurse!.avatar"
                  class="nurse-avatar-compact"
                  [alt]="(activeRequest()!.nurse?.firstName || 'Enfermera') + ' ' + (activeRequest()!.nurse?.lastName || '')"
                  loading="lazy" />
              } @else {
                <div class="nurse-avatar-compact nurse-avatar-placeholder">
                  <ion-icon name="person" aria-hidden="true"></ion-icon>
                </div>
              }

              <div class="nurse-info-compact">
                <span class="nurse-name-compact">
                  {{ activeRequest()!.nurse?.firstName || 'Enfermera' }}
                  {{ activeRequest()!.nurse?.lastName || '' }}
                </span>
                <span class="service-name-compact">{{ activeRequest()!.service.name }}</span>
              </div>
            </div>

            <!-- Status Badge -->
            <ion-badge [color]="getStatusColor(activeRequest()!.status)" class="status-badge-compact">
              {{ getStatusLabel(activeRequest()!.status) }}
            </ion-badge>
          </div>

          <!-- Action Link -->
          <div class="action-link-compact">
            <span>Ver seguimiento</span>
            <ion-icon name="chevron-forward" aria-hidden="true"></ion-icon>
          </div>
        </ion-card-content>
      </ion-card>
    </section>
  }

  <!-- Quick Access Hub -->
  <nav id="tour-quick-actions" class="quick-access-hub" aria-label="Acciones rápidas">
    <button
      class="quick-btn"
      (click)="goToHistory()"
      aria-label="Ver historial de servicios">
      <ion-icon name="time-outline" class="quick-icon"></ion-icon>
      <span class="quick-label">Historial</span>
    </button>

    <button
      class="quick-btn"
      (click)="goToFavorites()"
      aria-label="Ver enfermeras favoritas">
      <ion-icon name="heart-outline" class="quick-icon"></ion-icon>
      <span class="quick-label">Favoritas</span>
    </button>

    <button
      class="quick-btn"
      (click)="goToSettings()"
      aria-label="Ir a configuración">
      <ion-icon name="settings-outline" class="quick-icon"></ion-icon>
      <span class="quick-label">Ajustes</span>
    </button>
  </nav>

  <!-- Recent Nurses Section -->
  @if (recentNurses().length > 0) {
    <section class="recent-nurses-section" aria-labelledby="recent-nurses-title">
      <h3 id="recent-nurses-title" class="section-title-compact">
        <ion-icon name="time-outline" aria-hidden="true"></ion-icon>
        Recientes
      </h3>
      <div class="recent-nurses-list" role="list">
        @for (nurse of recentNurses(); track nurse.nurseId) {
          <button
            class="recent-nurse-item"
            role="listitem"
            (click)="selectRecentNurse(nurse)"
            [attr.aria-label]="'Solicitar servicio de ' + (nurse.firstName || 'enfermera') + ' ' + (nurse.lastName || '')">
            @if (nurse.avatar) {
              <img [src]="nurse.avatar" class="nurse-avatar-recent"
                   [alt]="(nurse.firstName || 'Enfermera') + ' ' + (nurse.lastName || '')" loading="lazy" />
            } @else {
              <div class="nurse-avatar-recent nurse-avatar-placeholder">
                <ion-icon name="person" aria-hidden="true"></ion-icon>
              </div>
            }
            <span class="nurse-name-recent">{{ nurse.firstName || 'Enfermera' }}</span>
          </button>
        }
      </div>
    </section>
  }

  <!-- Bottom padding for tab bar -->
  <div class="bottom-spacer"></div>
</ion-content>
